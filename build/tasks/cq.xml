<project>
	<property name="cq.target_dir" value="${reports.target}/cq" />
	
	<!-- default target -->
	<target name="cq" depends="phplint,phpcpd,phpdcd" description="run all code-quality tools on source" />
	
	<!-- Preparation -->
	<target name="cq-prepare">
		<mkdir dir="${cq.target_dir}" />
	</target>
	
	<target name="phplint" description="run PHPLint (syntax check) on PHP files">
		<phplint haltonfailure="true" errorproperty="cq.phplint.hasError">
			<fileset dir=".">
				<include name="**/*.php" />
			</fileset>
		</phplint>
	</target>
	<target name="phpcpd" depends="cq-prepare" description="PHP Copy &amp; Paste detection (needs cpd)">
		<echo level="info" msg="running PHP copy &amp; paste detection" />
		<phpcpd file=".">
			<formatter type="default" outfile="${cq.target_dir}/cq/phpcpd_last.txt"/>
		</phpcpd>
	</target>
	<target name="phpdcd" depends="cq-prepare" description="PHP Dead Code Detection">
		<echo level="info" msg="PHP dead code detection" />
		<exec command="phpdcd ${project.basedir} | tee ${cq.target_dir}/`date +%F`_phpdcd.txt" escape="false" />
	</target>
	
	<!-- <target name="phpdepend" description="PHP Depend">
			<phpdepend>
				<fileset dir="${project.basedir}">
					<include name="lib/**/*.php" />
				</fileset>
				<logger type="jdepend-chart" outfile="${reportdir}/jdepend_chart.svg" />
				<logger type="overview-pyramid" outfile="${reportdir}/jdepend_pyramid.svg" />
				<analyzer type="coderank-mode" value="method" />
			</phpdepend>
		</target> -->
</project>